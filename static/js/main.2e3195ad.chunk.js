(this["webpackJsonpopen-season"]=this["webpackJsonpopen-season"]||[]).push([[0],{203:function(e,t,n){},208:function(e,t,n){"use strict";n.r(t);var a=n(9),r=n(0),o=n.n(r),i=n(10),c=n.n(i),l=(n(203),n(12)),u=n(248),s=n(254),d=n(260),v=n(261),f=n(247),p=n(253),h=n(255),m=n(47),g=n(13),b=n(65),j=n(15),O=n.n(j),x=n(58),w=n(252),T=Object(r.createContext)({}),I=function(e){var t=e.children,n=e.season,o=e.slidingWindowSize,i=Object(w.a)(Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.openligadb.de/api/getavailableteams/bl1/".concat(n));case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)}))),[n]),c=Object(w.a)(Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.openligadb.de/api/getmatchdata/bl1/".concat(n));case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)}))),[n]),l=Object(r.useMemo)((function(){var e;return null===(e=c.value)||void 0===e?void 0:e[0].LeagueId}),[c.value]),u=Object(w.a)(Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://www.openligadb.de/api/getmatchdata/bl1/".concat(n-1));case 2:return t=e.sent,e.abrupt("return",t.json());case 4:case"end":return e.stop()}}),e)}))),[n]),s=Object(r.useMemo)((function(){var e,t,n,a,r;return null!==(e=null===(t=[].concat(Object(m.a)(null!==(a=u.value)&&void 0!==a?a:[]),Object(m.a)(null!==(r=c.value)&&void 0!==r?r:[])))||void 0===t||null===(n=t.filter((function(e){return!0===e.MatchIsFinished})))||void 0===n?void 0:n.flatMap((function(e,t,n){return[e.Team1,e.Team2].map((function(t){var n,a,r=(n=e,a=t.TeamId,(null===n||void 0===n?void 0:n.Team1.TeamId)===a),o=function(e){var t;return null===e||void 0===e||null===(t=e.MatchResults)||void 0===t?void 0:t.find((function(e){return 2===(null===e||void 0===e?void 0:e.ResultTypeID)}))}(e),i=function(e,t){var n=0;return 1===e&&t||-1===e&&!t?n=3:0===e&&(n=1),n}(function(e){return e&&Math.sign(e.PointsTeam1-e.PointsTeam2)}(o),r);return{dateTime:new Date(null===e||void 0===e?void 0:e.MatchDateTimeUTC),goalsAgainst:r?null===o||void 0===o?void 0:o.PointsTeam2:null===o||void 0===o?void 0:o.PointsTeam1,goalsFor:r?null===o||void 0===o?void 0:o.PointsTeam1:null===o||void 0===o?void 0:o.PointsTeam2,isHome:r,matchDay:null===e||void 0===e?void 0:e.Group.GroupOrderID,opponentId:r?null===e||void 0===e?void 0:e.Team2.TeamId:null===e||void 0===e?void 0:e.Team1.TeamId,points:i,seasonId:e.LeagueId,teamId:r?null===e||void 0===e?void 0:e.Team1.TeamId:null===e||void 0===e?void 0:e.Team2.TeamId}}))})))&&void 0!==e?e:[]}),[c.value,u.value]),d=Object(r.useMemo)((function(){return null===s||void 0===s?void 0:s.map((function(e,t,n){var a=n.slice(0,t+1).filter((function(t){return t.teamId===e.teamId})).slice(0-o).reduce((function(e,t,n,a){return e+t.points}),0);return Object(b.a)(Object(b.a)({},e),{},{pointsTotal:a})})).filter((function(e){return e.seasonId===l}))}),[s,l,o]),v=Object(r.useMemo)((function(){return{season:n,derivedMatchData:s,derivedMatchDataAggregates:d,teams:i}}),[s,d,n,i]);return Object(a.jsx)(T.Provider,{value:v,children:t})},k=function(e){var t=e.selectedTeams,n=e.svgFontSize,o=e.svgHeight,i=e.svgMarginBottom,c=e.svgMarginLeft,u=e.svgMarginRight,s=e.svgMarginTop,d=e.svgWidth,v=Object(r.useContext)(T),f=v.derivedMatchData,p=v.derivedMatchDataAggregates,h=v.teams,b=Object(r.useMemo)((function(){return p.filter((function(e){return t.includes(e.teamId)}))}),[p,t]),j=Object(r.useRef)(null);return Object(r.useEffect)((function(){g.i(j.current).attr("viewBox",[0,0,d,o]).attr("font-family","sans-serif").attr("font-size",n).selectAll("*").remove();var e=g.h().domain(null===p||void 0===p?void 0:p.map((function(e){return e.matchDay}))).range([c,d-u]),a=g.g().domain(g.b(p,(function(e){return e.pointsTotal}))).range([o-i,s]);g.i(j.current).append("g").call((function(t){return t.style("font-size",n).attr("transform","translate(0,".concat(s,")")).call(g.a(e)).call((function(e){return e.select(".domain").remove()}))}));var r=g.f().x((function(t){return e(t.matchDay)})).y((function(e){return a(e.pointsTotal)}));g.i(j.current).append("g").attr("fill","none").attr("stroke","#000").selectAll("path").data(g.d(p.filter((function(e){return!t.includes(e.teamId)})),(function(e){return e.teamId}))).join("path").attr("d",(function(e){var t=Object(l.a)(e,2)[1];return r(t)})).attr("stroke","#aaa").call((function(e){return e.clone(!0)})).attr("stroke","#fff").attr("stroke-width",2),g.i(j.current).append("g").attr("fill","none").attr("stroke","#000").selectAll("path").data(g.d(b,(function(e){return e.teamId}))).join("path").attr("d",(function(e){var t=Object(l.a)(e,2)[1];return r(t)})).attr("stroke","#f00").call((function(e){return e.clone(!0)})).attr("stroke","#fff").attr("stroke-width",2),g.i(j.current).append("g").attr("fill","#fff").selectAll("circle").data(b).join("circle").attr("cx",(function(t){return e(t.matchDay)})).attr("cy",(function(e){return a(e.pointsTotal)})).attr("r",n-1);var v=g.c(",");g.i(j.current).append("g").attr("text-anchor","middle").selectAll("text").data(b).join("text").attr("x",(function(t){return e(t.matchDay)})).attr("y",(function(e){return a(e.pointsTotal)})).attr("dy","0.35em").text((function(e){return v(e.pointsTotal)})),g.i(j.current).append("g").attr("text-anchor","end").selectAll("text").data(g.e(p,(function(e){var t,n;return null===(t=h.value)||void 0===t||null===(n=t.find((function(t){return t.TeamId===e.teamId})))||void 0===n?void 0:n.ShortName}))).join("text").attr("x",c-10).attr("y",(function(e){var t=Object(l.a)(e,2),n=t[0],r=Object(l.a)(t[1],1)[0];return a(r.pointsTotal)+10*("Colon"===n)})).attr("dy","0.35em").text((function(e){return Object(l.a)(e,1)[0]})),g.i(j.current).append("g").attr("text-anchor","start").selectAll("text").data(g.e(Object(m.a)(p).reverse(),(function(e){var t,n;return null===(t=h.value)||void 0===t||null===(n=t.find((function(t){return t.TeamId===e.teamId})))||void 0===n?void 0:n.ShortName}))).join("text").attr("x",d-u+10).attr("y",(function(e){var t=Object(l.a)(e,2),n=t[0],r=Object(l.a)(t[1],1)[0];return a(r.pointsTotal)+10*("Colon"===n)})).attr("dy","0.35em").text((function(e){return Object(l.a)(e,1)[0]}))}),[f,p,b,t,n,o,i,c,u,s,d,h]),Object(a.jsx)("svg",{ref:j})};k.defaultProps={svgFontSize:5,svgHeight:200,svgMarginBottom:20,svgMarginLeft:40,svgMarginRight:40,svgMarginTop:40,svgWidth:500};var M=k,y=n(240),S=n(256),C=n(249),P=n(258),D=n(259),N=Object(f.a)((function(e){return{chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2}}})),W=function(e){var t,n=e.onChange,o=e.value,i=Object(r.useContext)(T).teams,c=N();return Object(a.jsxs)(y.a,{children:[Object(a.jsx)(S.a,{id:"demo-mutiple-chip-label",children:"Teams"}),Object(a.jsx)(C.a,{labelId:"demo-mutiple-chip-label",multiple:!0,onChange:n,renderValue:function(e){return Object(a.jsx)("div",{className:c.chips,children:e.map((function(e){var t,n=null===(t=i.value)||void 0===t?void 0:t.find((function(t){return t.TeamId===e}));return Object(a.jsx)(P.a,{label:(null===n||void 0===n?void 0:n.ShortName)||(null===n||void 0===n?void 0:n.TeamName),className:c.chip},e)}))})},value:o,children:null===(t=i.value)||void 0===t?void 0:t.map((function(e){return Object(a.jsx)(D.a,{value:e.TeamId,children:e.ShortName||e.TeamName},e.TeamId)}))})]})},A=Object(f.a)((function(e){return{root:{display:"flex"},drawer:{width:200,flexShrink:0},drawerPaper:{padding:e.spacing(),width:200},content:{flexGrow:1,backgroundColor:e.palette.background.default},footer:{position:"absolute",bottom:0}}})),F=function(){var e=Object(r.useState)(2020),t=Object(l.a)(e,2),n=t[0],o=t[1],i=Object(r.useState)(34),c=Object(l.a)(i,2),f=c[0],m=c[1],g=Object(r.useState)([]),b=Object(l.a)(g,2),j=b[0],O=b[1],x=Object(p.a)().height,w=Object(h.a)(),T=Object(l.a)(w,2),k=T[0],y=T[1].width,S=A();return Object(a.jsx)("div",{children:Object(a.jsx)(I,{season:n,slidingWindowSize:f,children:Object(a.jsxs)("div",{className:S.root,children:[Object(a.jsx)(u.a,{}),Object(a.jsxs)(s.a,{anchor:"left",classes:{paper:S.drawerPaper},className:S.drawer,variant:"permanent",children:[Object(a.jsx)(d.a,{defaultValue:2020,label:"Season",onChange:function(e){o(parseInt(e.target.value,10))},select:!0,SelectProps:{native:!0},children:[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020].map((function(e){return Object(a.jsxs)("option",{value:e,children:[e,"/",e+1]},e)}))}),Object(a.jsx)(d.a,{defaultValue:34,inputProps:{max:34,min:5},label:"Matches",onChange:function(e){m(parseInt(e.target.value,10))},type:"number"}),Object(a.jsx)(W,{onChange:function(e){O(e.target.value)},value:j}),Object(a.jsx)("footer",{className:S.footer,children:Object(a.jsx)(v.a,{href:"https://github.com/phibo23/open-season",target:"_blank",variant:"caption",children:"github.com/phibo23/open-season"})})]}),Object(a.jsx)("main",{className:S.content,ref:k,children:Object(a.jsx)(M,{selectedTeams:j,svgHeight:x,svgWidth:y,svgFontSize:12,svgMarginLeft:80,svgMarginRight:80})})]})})})},L=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function z(e,t){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;null!=n&&(n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://cra.link/PWA."),t&&t.onUpdate&&t.onUpdate(e)):(console.log("Content is cached for offline use."),t&&t.onSuccess&&t.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}var R=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,263)).then((function(t){var n=t.getCLS,a=t.getFID,r=t.getFCP,o=t.getLCP,i=t.getTTFB;n(e),a(e),r(e),o(e),i(e)}))};c.a.render(Object(a.jsx)(o.a.StrictMode,{children:Object(a.jsx)(F,{})}),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("/open-season",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var t="".concat("/open-season","/service-worker.js");L?(!function(e,t){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(n){var a=n.headers.get("content-type");404===n.status||null!=a&&-1===a.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):z(e,t)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(t,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://cra.link/PWA")}))):z(t,e)}))}}(),R()}},[[208,1,2]]]);
//# sourceMappingURL=main.2e3195ad.chunk.js.map