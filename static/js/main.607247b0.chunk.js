(this["webpackJsonpopen-season"]=this["webpackJsonpopen-season"]||[]).push([[0],{203:function(t,e,n){},208:function(t,e,n){"use strict";n.r(e);var a=n(9),r=n(0),i=n.n(r),o=n(10),c=n.n(o),u=(n(203),n(12)),l=n(248),s=n(254),d=n(260),v=n(261),f=n(247),m=n(253),p=n(255),h=n(47),j=n(13),b=n(65),g=n(15),O=n.n(g),x=n(58),T=n(252),I=Object(r.createContext)({}),w=function(t){var e=t.children,n=t.season,i=t.slidingWindowSize,o=Object(T.a)(Object(x.a)(O.a.mark((function t(){var e;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://www.openligadb.de/api/getavailableteams/bl1/".concat(n));case 2:return e=t.sent,t.abrupt("return",e.json());case 4:case"end":return t.stop()}}),t)}))),[n]),c=Object(T.a)(Object(x.a)(O.a.mark((function t(){var e;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://www.openligadb.de/api/getmatchdata/bl1/".concat(n));case 2:return e=t.sent,t.abrupt("return",e.json());case 4:case"end":return t.stop()}}),t)}))),[n]),u=Object(r.useMemo)((function(){var t;return null===(t=c.value)||void 0===t?void 0:t[0].LeagueId}),[c.value]),l=Object(T.a)(Object(x.a)(O.a.mark((function t(){var e;return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fetch("https://www.openligadb.de/api/getmatchdata/bl1/".concat(n-1));case 2:return e=t.sent,t.abrupt("return",e.json());case 4:case"end":return t.stop()}}),t)}))),[n]),s=Object(r.useMemo)((function(){var t,e,n,a,r;return null!==(t=null===(e=[].concat(Object(h.a)(null!==(a=l.value)&&void 0!==a?a:[]),Object(h.a)(null!==(r=c.value)&&void 0!==r?r:[])))||void 0===e||null===(n=e.filter((function(t){return!0===t.MatchIsFinished})))||void 0===n?void 0:n.flatMap((function(t,e,n){return[t.Team1,t.Team2].map((function(e){var n,a,r=(n=t,a=e.TeamId,(null===n||void 0===n?void 0:n.Team1.TeamId)===a),i=function(t){var e;return null===t||void 0===t||null===(e=t.MatchResults)||void 0===e?void 0:e.find((function(t){return 2===(null===t||void 0===t?void 0:t.ResultTypeID)}))}(t),o=function(t,e){var n=0;return 1===t&&e||-1===t&&!e?n=3:0===t&&(n=1),n}(function(t){return t&&Math.sign(t.PointsTeam1-t.PointsTeam2)}(i),r);return{dateTime:new Date(null===t||void 0===t?void 0:t.MatchDateTimeUTC),goalsAgainst:r?null===i||void 0===i?void 0:i.PointsTeam2:null===i||void 0===i?void 0:i.PointsTeam1,goalsFor:r?null===i||void 0===i?void 0:i.PointsTeam1:null===i||void 0===i?void 0:i.PointsTeam2,isHome:r,matchDay:null===t||void 0===t?void 0:t.Group.GroupOrderID,opponentId:r?null===t||void 0===t?void 0:t.Team2.TeamId:null===t||void 0===t?void 0:t.Team1.TeamId,points:o,seasonId:t.LeagueId,teamId:r?null===t||void 0===t?void 0:t.Team1.TeamId:null===t||void 0===t?void 0:t.Team2.TeamId}}))})))&&void 0!==t?t:[]}),[c.value,l.value]),d=Object(r.useMemo)((function(){return null===s||void 0===s?void 0:s.map((function(t,e,n){var a=n.slice(0,e+1).filter((function(e){return e.teamId===t.teamId})).slice(0-i).reduce((function(t,e,n,a){return t+e.points}),0);return Object(b.a)(Object(b.a)({},t),{},{pointsTotal:a})})).filter((function(t){return t.seasonId===u}))}),[s,u,i]),v=Object(r.useMemo)((function(){return{season:n,derivedMatchData:s,derivedMatchDataAggregates:d,teams:o}}),[s,d,n,o]);return Object(a.jsx)(I.Provider,{value:v,children:e})},M=function(t){var e=t.selectedTeams,n=t.svgFontSize,i=t.svgHeight,o=t.svgMarginBottom,c=t.svgMarginLeft,l=t.svgMarginRight,s=t.svgMarginTop,d=t.svgWidth,v=Object(r.useContext)(I),f=v.derivedMatchData,m=v.derivedMatchDataAggregates,p=v.teams,b=Object(r.useMemo)((function(){return m.filter((function(t){return e.includes(t.teamId)}))}),[m,e]),g=Object(r.useRef)(null);return Object(r.useEffect)((function(){j.i(g.current).attr("viewBox",[0,0,d,i]).attr("font-family","sans-serif").attr("font-size",n).selectAll("*").remove();var t=j.h().domain(null===m||void 0===m?void 0:m.map((function(t){return t.matchDay}))).range([c,d-l]),a=j.g().domain(j.b(m,(function(t){return t.pointsTotal}))).range([i-o,s]);j.i(g.current).append("g").call((function(e){return e.style("font-size",n).attr("transform","translate(0,".concat(s,")")).call(j.a(t)).call((function(t){return t.select(".domain").remove()}))}));var r=j.f().x((function(e){return t(e.matchDay)})).y((function(t){return a(t.pointsTotal)}));j.i(g.current).append("g").attr("fill","none").attr("stroke","#000").selectAll("path").data(j.d(m.filter((function(t){return!e.includes(t.teamId)})),(function(t){return t.teamId}))).join("path").attr("d",(function(t){var e=Object(u.a)(t,2)[1];return r(e)})).attr("stroke","#aaa").call((function(t){return t.clone(!0)})).attr("stroke","#fff").attr("stroke-width",2),j.i(g.current).append("g").attr("fill","none").attr("stroke","#000").selectAll("path").data(j.d(b,(function(t){return t.teamId}))).join("path").attr("d",(function(t){var e=Object(u.a)(t,2)[1];return r(e)})).attr("stroke","#f00").call((function(t){return t.clone(!0)})).attr("stroke","#fff").attr("stroke-width",2),j.i(g.current).append("g").attr("fill","#fff").selectAll("circle").data(b).join("circle").attr("cx",(function(e){return t(e.matchDay)})).attr("cy",(function(t){return a(t.pointsTotal)})).attr("r",n-1);var v=j.c(",");j.i(g.current).append("g").attr("text-anchor","middle").selectAll("text").data(b).join("text").attr("x",(function(e){return t(e.matchDay)})).attr("y",(function(t){return a(t.pointsTotal)})).attr("dy","0.35em").text((function(t){return v(t.pointsTotal)})),j.i(g.current).append("g").attr("text-anchor","end").selectAll("text").data(j.e(m,(function(t){var e,n;return null===(e=p.value)||void 0===e||null===(n=e.find((function(e){return e.TeamId===t.teamId})))||void 0===n?void 0:n.ShortName}))).join("text").attr("x",c-10).attr("y",(function(t){var e=Object(u.a)(t,2),n=e[0],r=Object(u.a)(e[1],1)[0];return a(r.pointsTotal)+10*("Colon"===n)})).attr("dy","0.35em").text((function(t){return Object(u.a)(t,1)[0]})),j.i(g.current).append("g").attr("text-anchor","start").selectAll("text").data(j.e(Object(h.a)(m).reverse(),(function(t){var e,n;return null===(e=p.value)||void 0===e||null===(n=e.find((function(e){return e.TeamId===t.teamId})))||void 0===n?void 0:n.ShortName}))).join("text").attr("x",d-l+10).attr("y",(function(t){var e=Object(u.a)(t,2),n=e[0],r=Object(u.a)(e[1],1)[0];return a(r.pointsTotal)+10*("Colon"===n)})).attr("dy","0.35em").text((function(t){return Object(u.a)(t,1)[0]}))}),[f,m,b,e,n,i,o,c,l,s,d,p]),Object(a.jsx)("svg",{ref:g})};M.defaultProps={svgFontSize:5,svgHeight:200,svgMarginBottom:20,svgMarginLeft:40,svgMarginRight:40,svgMarginTop:40,svgWidth:500};var y=M,k=n(240),S=n(256),C=n(249),D=n(258),P=n(259),N=Object(f.a)((function(t){return{chips:{display:"flex",flexWrap:"wrap"},chip:{margin:2}}})),A=function(t){var e,n=t.onChange,i=t.value,o=Object(r.useContext)(I).teams,c=N();return Object(a.jsxs)(k.a,{children:[Object(a.jsx)(S.a,{id:"demo-mutiple-chip-label",children:"Teams"}),Object(a.jsx)(C.a,{labelId:"demo-mutiple-chip-label",multiple:!0,onChange:n,renderValue:function(t){return Object(a.jsx)("div",{className:c.chips,children:t.map((function(t){var e,n=null===(e=o.value)||void 0===e?void 0:e.find((function(e){return e.TeamId===t}));return Object(a.jsx)(D.a,{label:(null===n||void 0===n?void 0:n.ShortName)||(null===n||void 0===n?void 0:n.TeamName),className:c.chip},t)}))})},value:i,children:null===(e=o.value)||void 0===e?void 0:e.map((function(t){return Object(a.jsx)(P.a,{value:t.TeamId,children:t.ShortName||t.TeamName},t.TeamId)}))})]})},F=Object(f.a)((function(t){return{root:{display:"flex"},drawer:{width:200,flexShrink:0},drawerPaper:{padding:t.spacing(),width:200},content:{flexGrow:1,backgroundColor:t.palette.background.default},footer:{position:"absolute",bottom:0}}})),z=function(){var t=Object(r.useState)(2020),e=Object(u.a)(t,2),n=e[0],i=e[1],o=Object(r.useState)(34),c=Object(u.a)(o,2),f=c[0],h=c[1],j=Object(r.useState)([]),b=Object(u.a)(j,2),g=b[0],O=b[1],x=Object(m.a)().height,T=Object(p.a)(),I=Object(u.a)(T,2),M=I[0],k=I[1].width,S=F();return Object(a.jsx)("div",{children:Object(a.jsx)(w,{season:n,slidingWindowSize:f,children:Object(a.jsxs)("div",{className:S.root,children:[Object(a.jsx)(l.a,{}),Object(a.jsxs)(s.a,{anchor:"left",classes:{paper:S.drawerPaper},className:S.drawer,variant:"permanent",children:[Object(a.jsx)(d.a,{defaultValue:2020,label:"Season",onChange:function(t){i(parseInt(t.target.value,10))},select:!0,SelectProps:{native:!0},children:[2011,2012,2013,2014,2015,2016,2017,2018,2019,2020].map((function(t){return Object(a.jsxs)("option",{value:t,children:[t,"/",t+1]},t)}))}),Object(a.jsx)(d.a,{defaultValue:34,inputProps:{max:34,min:5},label:"Matches",onChange:function(t){h(parseInt(t.target.value,10))},type:"number"}),Object(a.jsx)(A,{onChange:function(t){O(t.target.value)},value:g}),Object(a.jsx)("footer",{className:S.footer,children:Object(a.jsx)(v.a,{href:"https://github.com/phibo23/open-season",target:"_blank",variant:"caption",children:"github.com/phibo23/open-season"})})]}),Object(a.jsx)("main",{className:S.content,ref:M,children:Object(a.jsx)(y,{selectedTeams:g,svgHeight:x,svgWidth:k,svgFontSize:12,svgMarginLeft:80,svgMarginRight:80})})]})})})},L=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,263)).then((function(e){var n=e.getCLS,a=e.getFID,r=e.getFCP,i=e.getLCP,o=e.getTTFB;n(t),a(t),r(t),i(t),o(t)}))};c.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(z,{})}),document.getElementById("root")),L()}},[[208,1,2]]]);
//# sourceMappingURL=main.607247b0.chunk.js.map